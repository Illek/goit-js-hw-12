{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { loadMoreBtn } from '../main';\n\nconst authKey = '44303353-9b630a8fdc8cdbe3ae770ff69';\nconst perPage = 15;\nlet page = 1;\nlet currentSearchValue = '';\n\nexport async function fetchImages(searchValue) {\n  page = 1;\n  currentSearchValue = searchValue;\n  clearImages();\n\n  showLoader();\n  hideLoadMoreBtn();\n\n  const searchParams = createSearchParams(searchValue, page);\n  const URL = createUrl(searchParams);\n\n  try {\n    const response = await axios.get(URL);\n    return response.data;\n  } catch (error) {\n    showToast(error.message, 'search-error', '#EF4040');\n  } finally {\n    hideLoader();\n  }\n}\n\nexport async function loadMore() {\n  if (!currentSearchValue) return;\n\n  page += 1;\n  const searchParams = createSearchParams(currentSearchValue, page);\n  const URL = createUrl(searchParams);\n\n  try {\n    const response = await axios.get(URL);\n    const { totalHits } = response.data;\n    const totalPages = Math.ceil(totalHits / perPage);\n\n    if (page > totalPages) {\n      hideLoadMoreBtn();\n      showEndOfResultsMessage();\n      return;\n    }\n\n    return response.data;\n  } catch (error) {\n    showToast(error.message, 'load-more-error', '#EF4040');\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction clearImages() {\n  const listOfImages = document.querySelector('#images');\n  listOfImages.innerHTML = '';\n}\n\nfunction showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'none';\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction createSearchParams(query, page) {\n  return new URLSearchParams({\n    key: authKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page,\n  });\n}\n\nfunction createUrl(params) {\n  return `https://pixabay.com/api/?${params}`;\n}\n\nfunction showEndOfResultsMessage() {\n  iziToast.show({\n    class: 'search-404',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutUp',\n    theme: 'dark',\n    closeOnClick: true,\n  });\n}\n\nfunction showToast(message, className, backgroundColor) {\n  iziToast.show({\n    class: className,\n    message,\n    position: 'topRight',\n    backgroundColor,\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutUp',\n    theme: 'dark',\n    closeOnClick: true,\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst listOfImages = document.querySelector('#images');\n\nexport default function createMarkup(fetchedData) {\n  const markup = fetchedData.hits.map(createImageMarkup).join('');\n  listOfImages.insertAdjacentHTML('beforeend', markup);\n\n  initializeLightbox();\n}\n\nfunction createImageMarkup(image) {\n  return `\n    <li class=\"images-image\">\n      <div class=\"gallery\">\n        <a href=\"${image.largeImageURL}\">\n          <img class=\"img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" title=\"${image.tags}\"/>\n        </a>\n      </div>\n      <ul class=\"image-details-container\">\n        <li>\n          <h2 class=\"image-heading\">Likes</h2>\n          <p class=\"image-description\">${image.likes}</p>\n        </li>\n        <li>\n          <h2 class=\"image-heading\">Views</h2>\n          <p class=\"image-description\">${image.views}</p>\n        </li>\n        <li>\n          <h2 class=\"image-heading\">Comments</h2>\n          <p class=\"image-description\">${image.comments}</p>\n        </li>\n        <li>\n          <h2 class=\"image-heading\">Downloads</h2>\n          <p class=\"image-description\">${image.downloads}</p>\n        </li>\n      </ul>\n    </li>`;\n}\n\nfunction initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'title',\n    captionDelay: 350,\n    fadeSpeed: 220,\n  });\n  lightbox.refresh();\n}\n","import { fetchImages, loadMore } from './js/pixabay-api';\nimport createMarkup from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nexport const loadMoreBtn = document.querySelector('.load-more-btn');\nconst loader = document.querySelector('.loader');\nlet currentKeyword = '';\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  loader.style.display = 'block';\n\n  const inputValue = e.currentTarget.elements.search.value.trim();\n  if (!inputValue) {\n    loader.style.display = 'none';\n    return;\n  }\n\n  currentKeyword = inputValue;\n  try {\n    const data = await fetchImages(inputValue);\n    handleFetchResults(data);\n  } catch (error) {\n    handleError(error);\n  } finally {\n    form.reset();\n    loader.style.display = 'none';\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n\n  try {\n    const data = await loadMore();\n    handleLoadMoreResults(data);\n  } catch (error) {\n    handleError(error);\n  } finally {\n    loader.style.display = 'none';\n  }\n});\n\nfunction handleFetchResults(data) {\n  const images = document.querySelector('#images');\n\n  if (data.total === 0) {\n    images.innerHTML = '';\n    showToast(\n      'Sorry, there are no images matching your search query. Please, try again!',\n      'search-404',\n      '#EF4040'\n    );\n    loadMoreBtn.style.display = 'none';\n    return;\n  }\n\n  createMarkup(data);\n\n  // Check if the number of images is less than 15\n  if (data.hits.length < 15) {\n    loadMoreBtn.style.display = 'none';\n  } else {\n    loadMoreBtn.style.display = 'block';\n  }\n}\n\nfunction handleLoadMoreResults(data) {\n  if (!data) {\n    return;\n  }\n\n  const card = document.querySelector('.images-image');\n  const cardHeight = card.getBoundingClientRect().height;\n\n  createMarkup(data);\n  window.scrollBy(0, cardHeight * 2);\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction handleError(error) {\n  showToast(error.message, 'load-error', '#EF4040');\n}\n\nfunction showToast(message, className, backgroundColor) {\n  iziToast.show({\n    class: className,\n    message,\n    position: 'topRight',\n    backgroundColor,\n    transitionIn: 'bounceInDown',\n    transitionOut: 'fadeOutUp',\n    theme: 'dark',\n    closeOnClick: true,\n  });\n}\n"],"names":["authKey","perPage","page","currentSearchValue","fetchImages","searchValue","clearImages","showLoader","hideLoadMoreBtn","searchParams","createSearchParams","URL","createUrl","axios","error","showToast","hideLoader","loadMore","response","totalHits","totalPages","showEndOfResultsMessage","listOfImages","loader","loadMoreBtn","query","params","iziToast","message","className","backgroundColor","createMarkup","fetchedData","markup","createImageMarkup","initializeLightbox","image","SimpleLightbox","form","inputValue","data","handleFetchResults","handleError","handleLoadMoreResults","images","cardHeight"],"mappings":"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"}